import{_ as U,d as $,r as B,o as s,c as f,a as l,w as i,b as r,e as n,g,f as _,E as W}from"./index-77ab94be.js";import{E as b,a as z,b as T,c as L}from"./el-table-column-f3d31b50.js";import{E as R,a as S,b as N,c as M}from"./el-button-d66579c7.js";import{E as j,a as A,b as q}from"./el-card-5d09da19.js";import{E as G,a as O}from"./el-select-1b3622b0.js";import{E as H,a as J}from"./el-col-36a0b091.js";import{f as c}from"./fileInfo-28e51b51.js";/* empty css                   */import{E as K}from"./el-message-box-e6138db0.js";const Q=$({data(){return{formData:[],fileInfo:{},dialogFormVisible:!1,searchFolderId:[],selectedFile:null,fileUrl:null,formLabelWidth:80,fileData:[],fileCount:0,pageSize:5,currentPage:1}},methods:{getFileExtension(e){return e.substring(e.lastIndexOf(".")+1).toLowerCase()},isImage(e){const o=["jpg","jpeg","png"],a=this.getFileExtension(e);return o.includes(a)},isPdf(e){const o=["pdf"],a=this.getFileExtension(e);return o.includes(a)},isWord(e){const o=["doc","docx"],a=this.getFileExtension(e);return o.includes(a)},istxt(e){const o=["txt"],a=this.getFileExtension(e);return o.includes(a)},isPPT(e){const o=["ppt","pptx","pps","ppsx"],a=this.getFileExtension(e);return o.includes(a)},isExcel(e){const o=["xls","xlsx"],a=this.getFileExtension(e);return o.includes(a)},isVideo(e){const o=["mp4","avi","mkv","MP4"],a=this.getFileExtension(e);return o.includes(a)},previewImage(e){console.log("Preview Image:",e),alert("下载路径: "+e)},previewPdf(e){console.log("Preview PDF:",e)},previewWord(e){console.log("Preview Word:",e)},previewExcel(e){console.log("Preview Excel:",e)},previewVideo(e){console.log("Preview Video:",e)},initFileData(){c.all().then(e=>{this.fileData=e.data.fileInfos,this.fileCount=this.fileData.length})},initData(){c.all().then(e=>{this.fileData=e.data.fileInfos,this.fileCount=this.fileData.length,this.formData=this.getData(0,this.pageSize-1)})},handlePageChange(e){this.currentPage=e;const o=(e-1)*this.pageSize,a=o+this.pageSize-1;this.formData=this.getData(o,a)},getData(e,o){return this.fileData.slice(e,o+1)},handleFileUpload(e){console.log(e.target.files),this.selectedFile=e.target.files[0]},upload(){if(!this.selectedFile)return;const e=new FormData;e.append("file",this.selectedFile),c.cosUploadFile(e).then(o=>{this.fileUrl=o.data.filePath,console.log(this.fileUrl),this.fileInfo.url=this.fileUrl}).catch(o=>{console.error("文件上传失败:",o)})},excute(){if(this.fileInfo.id!=null)c.updateById(this.fileInfo).then(e=>{e.success?(b({type:"success",message:"编辑成功"}),this.initData()):b({type:"error",message:"编辑失败"})}),this.dialogFormVisible=!1;else{if(!this.fileInfo.url)return;c.add(this.fileInfo).then(e=>{e.success?(b({type:"success",message:"添加成功"}),this.initData()):b({type:"error",message:"添加失败"}),this.dialogFormVisible=!1})}},getFileInfoByFolder(){c.getFileInfoByFolderId(this.formData.folderId).then(e=>{this.formData.folderId?this.formData=e.data.fileInfos:this.initData()})},handleDelete(e){const o={id:e};K.confirm("你确定删除该行数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.deleteById(o).then(a=>{a.success?(b({type:"success",message:"删除成功"}),this.initData()):b({type:"error",message:"删除失败"})})}).catch(()=>{b({type:"warning",message:"取消删除"})})},handleEdit(e){this.dialogFormVisible=!0,c.queryById(e).then(o=>{this.fileInfo=o.data.fileInfo})},toAdd(){this.dialogFormVisible=!0,this.fileInfo={}}},computed:{valueForStatistic(){return this.fileCount}},mounted(){this.initData(),this.initFileData(),this.handlePageChange(1)}}),X={class:""},Y={class:"table"},Z={key:0},ee=["src","onClick"],te={key:1},le=["href"],oe={key:2},ie=["href"],ne={key:3},ae=["href"],se={key:4},de=["href"],re={key:5},fe=["href"],ue={key:6},pe=["href"],ce={key:7},me=["href"],he={class:"dialog-footer"};function ge(e,o,a,_e,be,ye){const I=R,d=S,E=H,k=J,C=j,u=L,m=O,v=z,F=G,y=N,h=A,V=q,D=B("Upload"),w=W,P=M,x=T;return s(),f("div",X,[l(C,{id:"search"},{default:i(()=>[l(k,null,{default:i(()=>[l(E,{span:20},{default:i(()=>[l(I,{modelValue:e.formData.folderId,"onUpdate:modelValue":o[0]||(o[0]=t=>e.formData.folderId=t),placeholder:"文件夹ID",clearable:""},null,8,["modelValue"]),l(d,{onClick:e.getFileInfoByFolder,type:"primary",round:""},{default:i(()=>[n("查询")]),_:1},8,["onClick"])]),_:1}),l(d,{type:"success",onClick:e.toAdd,style:{"margin-left":"-280px"}},{default:i(()=>[n("添加")]),_:1},8,["onClick"])]),_:1})]),_:1}),r("div",Y,[l(v,{data:e.formData,style:{width:"100%"}},{default:i(()=>[l(u,{fixed:"",prop:"id",label:"编号",width:"150",align:"center"}),l(u,{prop:"name",label:"文件名称'",width:"120",align:"center"}),l(u,{prop:"size",label:"文件大小'",width:"120",align:"center"}),l(u,{label:"文件类型",width:"120",align:"center"},{default:i(({row:t})=>[t.type==0?(s(),g(m,{key:0},{default:i(()=>[n("图片")]),_:1})):_("",!0),t.type==1?(s(),g(m,{key:1},{default:i(()=>[n("视频")]),_:1})):_("",!0),t.type==2?(s(),g(m,{key:2},{default:i(()=>[n("文档")]),_:1})):_("",!0),t.type==3?(s(),g(m,{key:3},{default:i(()=>[n("表格")]),_:1})):_("",!0),t.type==4?(s(),g(m,{key:4},{default:i(()=>[n("ppt")]),_:1})):_("",!0),t.type==5?(s(),g(m,{key:5},{default:i(()=>[n("压缩包")]),_:1})):_("",!0),t.type==6?(s(),g(m,{key:6},{default:i(()=>[n("其它文件")]),_:1})):_("",!0)]),_:1}),l(u,{label:"文件预览",width:"200",align:"center"},{default:i(({row:t})=>[e.isImage(t.url)?(s(),f("div",Z,[r("img",{src:t.url,alt:"url",style:{width:"100px",height:"100px"},onClick:p=>e.previewImage(t.url)},null,8,ee)])):e.isPdf(t.url)?(s(),f("div",te,[r("a",{href:t.url,target:"_blank",style:{"text-decoration":"none"}},[l(d,{type:"success",onClick:p=>e.previewPdf(t.url)},{default:i(()=>[n("预览PDF文档")]),_:2},1032,["onClick"])],8,le)])):e.isWord(t.url)?(s(),f("div",oe,[r("a",{href:`https://docs.google.com/viewer?url=${encodeURIComponent(t.url)}&embedded=true`,target:"_blank",style:{"text-decoration":"none"}},[l(d,{type:"success",onClick:p=>e.previewWord(t.url)},{default:i(()=>[n("预览Word文档")]),_:2},1032,["onClick"])],8,ie)])):e.isVideo(t.url)?(s(),f("div",ne,[r("a",{href:t.url,target:"_blank",style:{"text-decoration":"none"}},[l(d,{type:"success",onClick:p=>e.previewVideo(t.url)},{default:i(()=>[n("预览视频")]),_:2},1032,["onClick"])],8,ae)])):e.isExcel(t.url)?(s(),f("div",se,[r("a",{href:`https://docs.google.com/viewer?url=${encodeURIComponent(t.url)}&embedded=true`,target:"_blank",style:{"text-decoration":"none"}},[l(d,{type:"success",onClick:p=>e.previewExcel(t.url)},{default:i(()=>[n("预览Excel表格")]),_:2},1032,["onClick"])],8,de)])):e.istxt(t.url)?(s(),f("div",re,[r("a",{href:`https://docs.google.com/viewer?url=${encodeURIComponent(t.url)}&embedded=true`,target:"_blank",style:{"text-decoration":"none"}},[l(d,{type:"success",onClick:p=>e.previewExcel(t.url)},{default:i(()=>[n("预览txt文档")]),_:2},1032,["onClick"])],8,fe)])):e.isPPT(t.url)?(s(),f("div",ue,[r("a",{href:`https://docs.google.com/viewer?url=${encodeURIComponent(t.url)}&embedded=true`,target:"_blank",style:{"text-decoration":"none"}},[l(d,{type:"success",onClick:p=>e.previewExcel(t.url)},{default:i(()=>[n("预览PPT")]),_:2},1032,["onClick"])],8,pe)])):(s(),f("div",ce,[r("a",{href:t.url,target:"_blank",style:{"text-decoration":"none"}},[l(d,{type:"success"},{default:i(()=>[n("预览未知文件")]),_:1})],8,me)]))]),_:1}),l(u,{prop:"folderId",label:"文件夹ID",width:"120",align:"center"}),l(u,{prop:"description",label:"描述",width:"120",align:"center"}),l(u,{fixed:"right",label:"操作",width:"180",align:"center"},{default:i(t=>[l(d,{type:"primary",onClick:p=>e.handleEdit(t.row.id)},{default:i(()=>[n("编辑")]),_:2},1032,["onClick"]),l(d,{type:"danger",onClick:p=>e.handleDelete(t.row.id)},{default:i(()=>[n("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(F,{small:"",background:"",layout:"prev, pager, next",total:e.fileCount,"page-size":e.pageSize,class:"mt-4",onCurrentChange:e.handlePageChange},null,8,["total","page-size","onCurrentChange"])]),l(x,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":o[9]||(o[9]=t=>e.dialogFormVisible=t),title:"添加/编辑"},{footer:i(()=>[r("span",he,[l(d,{onClick:o[7]||(o[7]=t=>e.dialogFormVisible=!1)},{default:i(()=>[n("取消")]),_:1}),l(d,{type:"primary",onClick:o[8]||(o[8]=t=>e.excute())},{default:i(()=>[n(" 确定 ")]),_:1})])]),default:i(()=>[l(P,{model:e.fileInfo},{default:i(()=>[l(y,{label:"文件名称","label-width":e.formLabelWidth},{default:i(()=>[l(I,{modelValue:e.fileInfo.name,"onUpdate:modelValue":o[1]||(o[1]=t=>e.fileInfo.name=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(y,{label:"文件大小","label-width":e.formLabelWidth},{default:i(()=>[l(I,{modelValue:e.fileInfo.size,"onUpdate:modelValue":o[2]||(o[2]=t=>e.fileInfo.size=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(y,{label:"文件类型","label-width":e.formLabelWidth},{default:i(()=>[l(V,{modelValue:e.fileInfo.type,"onUpdate:modelValue":o[3]||(o[3]=t=>e.fileInfo.type=t)},{default:i(()=>[l(h,{label:0},{default:i(()=>[n("图片")]),_:1}),l(h,{label:1},{default:i(()=>[n("视频")]),_:1}),l(h,{label:2},{default:i(()=>[n("文档")]),_:1}),l(h,{label:3},{default:i(()=>[n("表格")]),_:1}),l(h,{label:4},{default:i(()=>[n("PPT")]),_:1}),l(h,{label:5},{default:i(()=>[n("压缩包")]),_:1}),l(h,{label:6},{default:i(()=>[n("其他文件")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(y,{label:"文件夹ID","label-width":e.formLabelWidth},{default:i(()=>[l(I,{modelValue:e.fileInfo.folderId,"onUpdate:modelValue":o[4]||(o[4]=t=>e.fileInfo.folderId=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(y,{label:"文件上传","label-width":e.formLabelWidth},{default:i(()=>[r("input",{type:"file",onChange:o[5]||(o[5]=(...t)=>e.handleFileUpload&&e.handleFileUpload(...t)),style:{"margin-left":"60px"}},null,32),l(d,{type:"primary",onClick:e.upload,style:{"margin-left":"30px"}},{default:i(()=>[n(" 上传"),l(w,{class:"el-icon--right"},{default:i(()=>[l(D)]),_:1})]),_:1},8,["onClick"])]),_:1},8,["label-width"]),l(y,{label:"描述","label-width":e.formLabelWidth},{default:i(()=>[l(I,{modelValue:e.fileInfo.description,"onUpdate:modelValue":o[6]||(o[6]=t=>e.fileInfo.description=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const Pe=U(Q,[["render",ge],["__scopeId","data-v-aa9aca0f"]]);export{Pe as default};
